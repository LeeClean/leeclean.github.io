# Receipt_Manager
해외출장 영수증 관리시스템 v1.2

## 해외출장 영수증 관리 시스템 - 기능 명세서
### 1. 개요
본 문서는 '해외출장 영수증 관리 시스템 v1.2'의 구조와 기능에 대한 명세서입니다. 이 시스템은 사용자가 해외 출장 중 발생한 USD 영수증을 이미지 또는 수기 입력으로 등록하고, 적용 환율에 따라 KRW로 자동 변환하여 내역을 관리, 통계 확인, CSV 파일로 내보내는 기능을 제공하는 브라우저 기반의 단일 페이지 웹 애플리케이션(SPA)입니다.

### 2. 파일 구조 및 기술 스택
#### 2.1. 파일 구조
index.html (단일 파일): HTML, CSS, JavaScript 코드가 모두 포함된 단일 파일 구조로, 별도의 서버나 빌드 과정 없이 브라우저에서 바로 실행 가능합니다.

#### 2.2. 주요 기술 스택
- HTML5: 웹 페이지의 기본 구조를 정의합니다.
- Tailwind CSS: UI 디자인 및 레이아웃을 위한 CSS 프레임워크입니다.
- Font Awesome: 아이콘 표시를 위한 라이브러리입니다.
- Vanilla JavaScript (ES6+): 외부 프레임워크 없이 순수 자바스크립트로 모든 동적 기능을 구현합니다.
- Chart.js: 항목별, 사용처별 지출 통계를 시각화하기 위한 차트 라이브러리입니다.
- Tesseract.js: 영수증 이미지에서 텍스트를 추출(OCR)하는 자바스크립트 라이브러리입니다.
- Browser localStorage: 사용자가 입력한 영수증 데이터를 브라우저에 영구적으로 저장하는 데 사용됩니다.
- ExchangeRate-API: 실시간 환율 정보를 비동기적으로 가져오는 데 사용되는 외부 API입니다.

### 3. 화면 구성 (UI Layout)
UI는 크게 4개의 주요 섹션으로 구성됩니다.

섹션 / 설명
- 페이지 헤더 / 시스템의 제목과 간단한 설명을 표시합니다.
- 메인 입력 영역 / 영수증 미리보기와 영수증 정보 입력 폼으로 구성됩니다. 사용자는 이곳에서 영수증 정보를 입력하고 이미지를 업로드합니다.
- 영수증 기록 테이블 / 저장된 모든 영수증 내역이 테이블 형태로 표시됩니다. 날짜, 항목, 사용처별 정렬 기능과 개별 항목의 수정/삭제 기능을 제공합니다.
- 통계 요약 대시보드 / 전체 영수증 수, 총지출(USD/KRW), 평균 지출을 요약하여 보여주고, 항목별/사용처별 지출 분포를 파이 차트로 시각화합니다.

### 4. JavaScript 함수 명세
애플리케이션의 로직은 기능별로 명확하게 구분된 순수 자바스크립트 함수들로 구현되어 있습니다.

#### 4.1. 전역 변수 및 상태 관리
- receipts: 모든 영수증 데이터를 저장하는 배열 (Array).
- currentExchangeRate: API로부터 가져온 현재 환율을 저장하는 변수.
- editingIndex: 수정 중인 영수증의 인덱스를 저장하는 변수. -1일 경우 새 영수증 입력을 의미.
- sortState: 테이블의 정렬 상태(정렬 기준 컬럼, 방향)를 저장하는 객체.

#### 4.2. 주요 함수 설명
함수명 / 구분 / 설명 / 주요 로직

- initializeEventListeners() / 초기화 / 페이지 로드 시 모든 DOM 요소에 이벤트 리스너를 설정합니다.
addEventListener를 사용하여 각 버튼, 입력 필드, 드래그 앤 드롭 영역에 대한 이벤트 핸들러를 연결합니다.

- loadReceipts() / storeReceipts() / 데이터 관리 / localStorage에서 영수증 데이터를 불러오거나 저장합니다.
JSON.parse()와 JSON.stringify()를 사용하여 데이터를 직렬화/역직렬화합니다.

- saveReceipt() / 핵심 기능 / 입력 폼의 데이터를 검증하고 receipts 배열에 저장 또는 수정합니다.
필수 입력값(날짜, 사용처) 확인 후, 신규 데이터는 push, 수정 데이터는 해당 인덱스에 재할당합니다.

- editReceipt() , deleteReceipt() / 핵심 기능 / 특정 영수증을 수정 모드로 전환하거나 삭제합니다.
editingIndex를 설정하고 폼에 데이터를 채우거나, splice를 사용해 배열에서 데이터를 제거합니다.

- renderAll() / 렌더링 / 데이터 변경 시 관련된 모든 UI(테이블, 통계, 차트)를 업데이트하는 메인 함수입니다.
renderReceiptsTable(), updateStatistics(), updateCharts()를 순차적으로 호출합니다.

- renderReceiptsTable() / 렌더링 / receipts 배열을 기반으로 HTML 테이블을 동적으로 생성합니다.
map() 함수로 배열을 순회하며 각 영수증에 대한 <tr> 태그 문자열을 생성하고 innerHTML에 할당합니다.

- updateStatistics() / 렌더링 / receipts 배열을 분석하여 통계 대시보드 정보를 계산하고 업데이트합니다.
reduce() 함수로 총합을 계산하고, 이를 바탕으로 총 영수증 수, 총지출, 평균 지출을 계산하여 표시합니다.

- updateCharts() / 렌더링 / Chart.js 인스턴스의 데이터를 업데이트하여 차트를 다시 그립니다.
receipts 데이터를 항목별/사용처별로 그룹화하고 합산하여 차트 데이터셋을 갱신한 후, chart.update()를 호출합니다.

- fetchExchangeRate() / 외부 연동 / ExchangeRate-API를 호출하여 최신 USD-KRW 환율 정보를 비동기적으로 가져옵니다.
fetch API와 async/await를 사용하여 비동기 네트워크 요청을 처리하고, 실패 시 기본값을 사용합니다.

- processOCR() / 외부 연동 / Tesseract.js를 사용하여 업로드된 이미지에서 텍스트를 추출합니다.
Tesseract.recognize() 함수를 호출하여 OCR을 수행하고, 결과 텍스트의 첫 줄을 '사용처' 입력 필드에 자동으로 채웁니다.

- sortTable() / UI 기능 / 테이블 헤더 클릭 시 지정된 컬럼을 기준으로 데이터를 정렬합니다.
sortState를 업데이트하고, Array.prototype.sort()를 사용하여 receipts 배열을 재정렬한 후 테이블을 다시 렌더링합니다.

- showToast() , showConfirmationModal() / UI 기능 / 사용자에게 피드백을 제공하기 위한 커스텀 알림(토스트, 모달)을 표시합니다.
동적으로 HTML 요소를 생성하여 화면에 추가하고, CSS 트랜지션을 이용해 부드러운 등장/사라짐 효과를 구현합니다.
